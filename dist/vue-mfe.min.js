/*!
  * vue-mfe v1.0.5
  * (c) 2019 Vuchan
  * @license MIT
  */
var e,n;e=this,n=function(e,n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;var t=function(e){return Array.isArray(e)},r=function(e){return e&&"function"==typeof e},o=function(e){return e&&"object"==typeof e},i=function(e){return"string"==typeof e},u=new Map,a=function(){return s().router},c=function(){return a().app},f=function(e){return s(e).globalVar||"__domain__app__"+e},s=function(e){return void 0===e&&(e="*"),u.get(e)||{}},l=function(e,n){return o(e)&&(e=(n=e).prefix||"*"),!(!i(e)||!o(n))&&u.set(e,n)},p=!1,h="undefined"!=typeof console&&"function"==typeof console.warn,d=function(){if(p)throw Error.apply(window,arguments);h&&console.warn.apply(arguments)},v=function(e){return e&&e.default||e},m=function(e,n){return void 0===n&&(n="/"),e.split(n||".").filter(Boolean).map(function(e){return e.trim()}).shift()};function y(e){e&&e instanceof HTMLElement&&("function"==typeof e.remove?e.remove():e.parentNode.removeChild(e))}var g={};function E(e){return g[e]||w(e).then(function(n){var i=r(n)?n():n;try{return p&&o(i)&&!t(i)?i:g[e]=O((t(i)?i:[i]).filter(Boolean),f(e))}catch(e){throw console.log("error: ",e),new Error(e)}})}var w=function(e){return Promise.resolve(function(e){var n=s(e);if(n&&n.resources||(n=s()),n&&n.resources){if(r(n.resources))return n.resources();if(o(n.resources))return n.resources}}(e)).then(function(n){return void 0===n&&(n={}),n[e]||d("The App key '"+e+"' cannot be found in "+JSON.stringify(n))})},O=function(e,n){var r=e.filter(function(e){return e.endsWith(".css")}),o=e.filter(function(e){return e.endsWith(".js")});if(t(r)&&r.length&&Promise.all(r.map(function(e){return n=e,(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.charset="utf-8",t.href=n,t.setAttribute("force",!1),new Promise(function(e,n){var r=setTimeout(function(){return o(!0)},12e3);function o(e){clearTimeout(r),t.onerror=t.onload=t.onreadystatechange=null,e&&t&&y(t)}t.onload=function(){o(),e.apply(void 0,arguments)},t.onerror=function(){o(!0),n.apply(void 0,arguments)},document.head.appendChild(t)});var n,t})).catch(d),t(o)&&o.length)return A(o.map(function(e){return function(){return function(e,n){var t=document.createElement("script");return t.type="text/javascript",t.charset="utf-8",t.src=e,t.async=!0,t.setAttribute("nonce","nonce"),new Promise(function(r,o){var i=setTimeout(function(){return c("Reject script "+e+": LOAD_SCRIPT_TIMEOUT")},12e3);function u(){clearTimeout(i),t.onerror=t.onload=t.onreadystatechange=null,y(t)}function a(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];u(),r.apply(void 0,[n?window[n]:void 0].concat(t))}function c(){u(),o.apply(void 0,arguments)}void 0!==t.readyState?t.onreadystatechange=function(e){"loaded"!==t.readyState&&"complete"!==t.readyState||n&&!window[n]?c("Unknown error happened",e):a()}:(t.onload=a,t.onerror=function(n){c("GET "+e+" net::ERR_CONNECTION_REFUSED",n)}),document.body.appendChild(t)})}(e,n)}})).catch(function(e){d(e)});d("No any valid script be found in "+e)},A=function(e){return e.reduce(function(e,n){return e.then(function(e){return n(e)}).catch(function(e){throw e})},Promise.resolve())},b=function(e){if(!s())throw new Error("Before you calls `VueMfe.Lazy(url: string)` must setting its config use like `VueMfe.lazy.setConfig({ resource: Resources })`");var n=s(e).name,t=e.slice(n.length+1);return n&&E(n).then(function(e){var n,o=(n=e,t.split(".").reduce(function(e,n){return e[n]},n));return r(o)?o():o})};b.setConfig=function(e){l(e)};var P=1,R=Object.freeze({SUCCESS:P,START:0,FAILED:-1}),T={};function _(e){return T[e]===P}function x(e,n){return T[e]=n}function j(e,n){return"/"===n&&"/"!==e&&e.startsWith("/")?S(e):S(n)+S(e)}function S(e){return(e="/"!==e?e.replace(/\/?$/,""):e)?function(e){return"/"===e.charAt(0)}(e)?e:"/"+e:"/"}var C=function(e,n){var t,r=[],o=0,i=0,u="",a=n&&n.delimiter||L,c=n&&n.whitelist||void 0,f=!1;for(;null!==(t=$.exec(e));){var s=t[0],l=t[1],p=t.index;if(u+=e.slice(i,p),i=p+s.length,l)u+=l[1],f=!0;else{var h="",d=t[2],v=t[3],m=t[4],y=t[5];if(!f&&u.length){var g=u.length-1,E=u[g],w=!c||c.indexOf(E)>-1;w&&(h=E,u=u.slice(0,g))}u&&(r.push(u),u="",f=!1);var O="+"===y||"*"===y,A="?"===y||"*"===y,b=v||m,P=h||a;r.push({name:d||o++,prefix:h,delimiter:P,optional:A,repeat:O,pattern:b?M(b):"[^"+I(P===a?P:P+a)+"]+?"})}}(u||i<e.length)&&r.push(u+e.substr(i));return r},D=function(e,n,t){for(var r=(t=t||{}).strict,o=!1!==t.start,i=!1!==t.end,u=t.delimiter||L,a=[].concat(t.endsWith||[]).map(I).concat("$").join("|"),c=o?"^":"",f=0;f<e.length;f++){var s=e[f];if("string"==typeof s)c+=I(s);else{var l=s.repeat?"(?:"+s.pattern+")(?:"+I(s.delimiter)+"(?:"+s.pattern+"))*":s.pattern;n&&n.push(s),s.optional?s.prefix?c+="(?:"+I(s.prefix)+"("+l+"))?":c+="("+l+")?":c+=I(s.prefix)+"("+l+")"}}if(i)r||(c+="(?:"+I(u)+")?"),c+="$"===a?"$":"(?="+a+")";else{var p=e[e.length-1],h="string"==typeof p?p[p.length-1]===u:void 0===p;r||(c+="(?:"+I(u)+"(?="+a+"))?"),h||(c+="(?="+I(u)+"|"+a+")")}return new RegExp(c,function(e){return e&&e.sensitive?"":"i"}(t))},L="/",$=new RegExp(["(\\\\.)","(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?"].join("|"),"g");function I(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function M(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function N(e){return e&&o(e)&&e.path&&e.component}var U=-2,k=Object.freeze({LOAD_ERROR_HAPPENED:-1,LOAD_DUPLICATE_WITHOUT_PATH:U,LOAD_APP_INIT_FAILED:-3}),z="load-error",V=Object.freeze({LOAD_START:"load-start",LOAD_SUCCESS:"load-success",LOAD_ERROR:z}),W=function(e){var n=e.name,i=e.next,u=e.to;if(_(n))return!0;var f=c();x(n,0),f.$emit("load-start",e);return E(n).then(function(e){return function(e){if(o(e)&&N(e))return a().addRoutes([e]);if(t(e)&&e.every(N))return a().addRoutes(e);var n=v(e),i=n.init,u=n.routes,f=n.parentPath,l=s().parentPath;return Promise.resolve(r(i)&&i(c())).then(function(){a().addRoutes(u,f||l)})}(e)}).then(function(){x(n,P),f.$emit("load-success",e),i&&u&&i(u)}).catch(function(t){t instanceof Error||(t=new Error(t)),t.code||(t.code=-1),x(n,-1),f.$emit(z,t,e),i&&i(!1)})},B={},H=function(e,n){e&&[].concat(e).forEach(function(e){"object"==typeof e?Object.keys(e).forEach(function(t){var r=e[t];B[j(r,n)]=t}):B[j(e,n)]=name})},F=function(e){var n=B[e];if(!n){var t=function(e,n){var t=Object.keys(e);if(t)for(var r=t.map(function(e){return D(C(e))}),o=0,i=r.length;o++<i;)if(r[o].test(n))return t[o]}(B,e);t&&(n=B[t])}return n?[].concat(n):null},q=function(e){var n=e.map(function(e){return W({name:e})});return Promise.all(n).then(function(e){return e.every(Boolean)})},G=[],J={},Y=function(e){return G.includes(e)},K=function(e){return J[e]},Q=function(e,n,t){return Y(n)?j(e,n):(d("Cannot found the parent path "+n+" "+(t?"of "+t:"")+" in router"),"")};function X(e,n){e.forEach(function(e){var t=e.path,r=e.parentPath,o=e.name,i=e.children,u=e.childrenApps;if(r?t=Q(t,r,o):n&&(t=Q(t,n,o)),t&&(Y(t)?d("The path "+t+" in pathList has been existed"):G.push(t)),o&&(K(o)?d("The name "+o+" in pathMap has been existed"):J[o]=t),H(u,t),i&&i.length)return X(i,t)}),p&&(console.log(G),console.log(J))}function Z(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&-1===n.indexOf(r)&&(t[r]=e[r]);return t}function ee(e,r,o){X(e,r),a().matcher=new n(function(e,n,t){var r=e.routes;void 0===r&&(r=[]);var o=Z(e,["routes"]),i=n.routes;void 0===i&&(i=[]);var u=Z(n,["routes"]);return Object.assign({routes:ne(r,i,t)},u,o)}(function(e){if(e){if(e instanceof n)return e.options;if(t(e))return{routes:e}}return{}}(o||a()),{routes:e},r)).matcher}function ne(e,n,t){var r=t;return n.forEach(function(n){if(i(n.parentPath)?(t=n.parentPath,delete n.parentPath):t=r,i(t))if(""===t)e.push(n);else{var o=function e(n,t){if(void 0===n&&(n=[]),n)for(var r,o=0;o<n.length;o++){if((r=n[o]).path===t)return r;if(r.children&&(r=e(r.children,t)))return r}}(e,t),u=n.path;o&&(o.children||(o.children=[])).push(Object.assign({},n,{path:t&&u.startsWith("/")?u=u.replace(/^\/*/,""):u}))}else e.push(n)}),e}function te(e){e.beforeEach(function(n,t,r){if(0!==n.matched.length&&0!==e.match(n.path).matched.length)return r();var u=(f=n.fullPath||n.path,i(f)?m(f):o(f)?f.prefix:void 0),a={name:u,to:n,from:t,next:r};if(!_(u))return W(a);var f,s=F(n.fullPath||n.path);if(s&&s.length)return function(e,n){var t=n.next,r=n.to;return q(e).then(function(e){return e&&t&&r&&t(r)}).catch(function(e){console.log("error: ",e)})}(s,a);!function(e,n){var t=new Error(e+" has been installed but it has no any path like "+n.path);t.code=U,c().$emit(z,t)}(u,n)})}var re={sensitive:!1,parentPath:"/",resources:function(){}};function oe(e){var n;l(Object.assign({},re,e)),(n=e.router).addRoutes!==ee&&(n.addRoutes=ee.bind(n)),X(n.options.routes),te(n)}function ie(e){if(!e.prefix)throw new Error("Missing property `prefix: string` in config");if(!e.routes)throw new Error("Missing property `routes: Route[]` in config");return l(e),e}var ue={version:"1.0.5",lazy:b,createApp:oe,createSubApp:ie,isInstalled:_,EVENT_TYPE:V,ERROR_CODE:k,LOAD_STATUS:R};e.createApp=oe,e.createSubApp=ie,e.default=ue,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("vue-router")):"function"==typeof define&&define.amd?define(["exports","vue-router"],n):n(e.VueMfe={},e.VueRouter);